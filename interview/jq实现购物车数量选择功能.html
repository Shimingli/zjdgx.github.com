<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>js/jq实现购物车数量选择功能</title>
<style>
.amount {
        margin: 20px 200px;
}
a {
        display: inline-block;
        width: 9px;
        height: 9px;
        line-height: 9px;
        background: white;
        text-decoration: none;
        text-align: center;
        color: #555;
        border: 1px solid #ccc;
}
a:hover {
        border-color: red;
}
.disabled,
.disabled:hover {
        color: #ccc;
        border-color: #ccc;
}
input#text {
        display: inline-block;
        width: 28px;
        padding: 1px 3px;
        text-align: right;
        color: #666;
}
#note {
        position: relative;
        width: 68px;
        margin-top: 6px;
        padding: 4px;
        line-height: 16px;
        border: 1px solid #FEC3A8;
        -webkit-border-radius: 2px;
        -moz-border-radius: 2px;
        -ms-border-radius: 2px;
        -o-border-radius: 2px;
        border-radius: 2px;
        background: white;
}
#note b,
#note i {
        position: absolute;
        left: 30px;
        width: 18px;
        height: 7px;
        font: 16px/21px Simsun;
        overflow: hidden;
}
#note b {
        top: -8px;
        color: #FEC3A8;
}
#note i {
        top: -7px;
        color: white;
}
#note em {
        font-size: 12px;
        font-style: normal;
        color: #F40;
}
.hide {
        display: none;
}
.show {
        display: block;
}
</style>
<script src="../common/script/jquery-1.10.2.min.js"></script>
</head>

<body>
<div class="amount"> <a href="#" id="minus">-</a>
	<input type="text" id="text" value="1" data-max='5' data-min='0'>
	<a href="#" id="plus">+</a>
	<p id="note" class="hide"> <b>◆</b> <i>◆</i> <em></em> </p>
</div>
<script>
//jquery
/*var $minus=$('#minus'),
        $plus=$('#plus'),
        $text=$('#text'),
        $note=$('#note'),
        maxNum=$text.data('max'),
        minNum=$text.data('min');
//显示提示信息
function showNote(note,$a){
        $note.show().find('em').text(note);
        s_a_r($a,'disabled');
}
//隐藏提示信息
function hideNote(){
        $note.hide();
        $('a').removeClass('disabled');
}                
function s_a_r(o,c){
        o.addClass(c).siblings().removeClass(c);        
}                
$minus.click(function(){
        var val=$text.val()*1;
        if(val>minNum){
                $text.val(val-1);
                hideNote();
        }
        if(val==minNum+1){
                showNote('不能少于'+minNum,$(this));        
        }
})
$plus.click(function(){
        var val=$text.val()*1;
        if(val<maxNum){
                $text.val(val+1);
                hideNote();
        }
        if(val==maxNum-1){
                showNote('最大不能超过'+maxNum,$(this));        
        }
})
$text.keyup(function(){
        var val=$(this).val().replace(/[^\d]/g,'');
        //$(this).val(val);
        if(val<=minNum){
                $text.val(minNum);
                $note.show().find('em').text('不能少于'+minNum);
                showNote('不能少于'+minNum,$minus);                
        }else if(val>=maxNum){
                $text.val(maxNum);
                showNote('最大不能超过'+maxNum,$plus);
        }else{
                hideNote();
        }
})
*/

//js
function Id(o){
        return document.getElementById(o);
}
var $minus=Id('minus'),
        $plus=Id('plus'),
        $text=Id('text'),
        $note=Id('note'),
        maxNum=$text.getAttribute('data-max'),
        minNum=$text.getAttribute('data-min');
        
//显示提示信息
function showNote(note,$a){
        var emNode=$note.getElementsByTagName("em")[0];
        $note.className='show';         
        emNode.innerText=note;
        $a.className='disabled';
}
//隐藏提示信息
function hideNote(){
        $note.className='hide';
        $minus.className=$plus.className='';
}                
//减少数量        
$minus.onclick=function(){
        var val=$text.value*1;
        if(val>minNum){
                $text.value=val-1;
                hideNote();
        }
        if(val==minNum+1){
                showNote('不能少于'+minNum,this);
        }
}
//添加数量
$plus.onclick=function(){
        var val=$text.value*1;
        if(val<maxNum){
                $text.value=val+1;
                hideNote();
        }
        if(val==maxNum-1){
                showNote('最大不能超过'+maxNum,this);
        }
}
//手动更改数量
$text.onkeyup=function(){
        var _this=this, 
                val=this.value=_this.value.replace(/[^\d]/g,'');
        if(val<=minNum){
                $text.value=minNum;
                showNote('不能少于'+minNum,$minus);
                $plus.className='';
        }else if(val>=maxNum){
                $text.value=maxNum;
                showNote('最大不能超过'+maxNum,$plus);
                $minus.className='';
        }else{
                hideNote();
        }
}
</script>
</body>
</html>