
<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="author" content="zjdgx"/>
    <meta name="date" content="2015/03/23"/>
    <title>nodejs redis</title>
    <link rel="stylesheet" href="../../style/notes.css">
</head>
<body>
<div class="main">
    <h1>Nodejs文件下载</h1>
	<pre class="prettyprint">
/**
 * nodejs file download
 * date: 2015-03-20
 * author: zjdgx
 */
var fs = require('fs'),
   path = require('path'),
   http = require('http'),
   contentUrl = process.argv[2] || 'http://www.cnblogs.com/skins/UnlimitedSunlight/images/banner.jpg';

http.get(contentUrl, function(res) {
   //如果不初始化，下载的图片将报错
   var data = '';
	
   console.log("Download started: " + contentUrl);
   res.setEncoding("binary");

   res.on('data', function(d) {
      data += d;
   });

   res.on('end', function() {
      fs.writeFile('./zjdgx.jpg', data, 'binary', function(err) {
         console.log('write file finished...');
      });

      console.log('Download finished...');
   });
});</pre>
</div>
</body>
</html>