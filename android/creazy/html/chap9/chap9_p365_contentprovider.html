<!doctype html>
<html><!-- InstanceBegin template="/Templates/zjdgx-notes.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="zjdgx" />
<!-- InstanceBeginEditable name="doctitle" -->
<meta name="description" content="第9章 使用ContentProvider实现数据共享(P365)"/>
<meta name="date" content="20140630" />
<title>zjdgx notes</title>
<!-- InstanceEndEditable -->
<!-- InstanceBeginEditable name="head" -->
<style type="text/css">
	html,body{
		background-color: #fff;
	}
	li{
		list-style: none;
	}
	.main{
		font: 12px/1.8 'microsoft yahei',courier new,times new roman;
	}
	.code {
		margin: 0;
		padding: 5px 10px;
		background-color:#e8e8e8;
		font-family: "Courier New", Courier, monospace;
	}
	p.code {
		margin-left: 2em;
	}
	pre.code {
		margin: 0.5em 0;
		line-height: 150%;
		padding: 0.4em 0.6em;
	}
	ol li {
		list-style: decimal;
	}
	.main h1{
		margin: 0;
		font-size: 14px;
	}
	.main h1 a {
		margin-left: 20px;
	}
	.main .point3 {
		padding-left: 5px;
		margin: 5px 0 5px 4em;
	}
	.main .em,
	.main .underline {
		text-decoration: underline;
	}
	.main .italic {
		font-style: italic;
	}
	.main h2 {
		margin: 0;
		margin-top: 10px;
		margin-left: 2em;
		font-size: 12px;
	}
	.main h3 {
		font-size: 12px;
		font-weight: normal;
		margin: 10px 0 0 3em;
	}
	.main ol {
		margin: 0;
		margin-left: 2em;
	}
	.main ol.h3 {
		margin: 0;
		font-size: 12px;
		margin-left: 4em;
	}
	h4 {
		margin: 0;
		text-indent: 5em;
		font-weight: normal;
	}
	table {
		border-collapse: collapse;
		margin-left: 5em;
	}
	table td,table th {
		padding: 2px 20px;
	}
	.table td,.table th {
		border: solid 1px #ccc;
	}
	.exampleCode {
		margin-left: 5em;
	}
	.example {
		width: 65px;
		color: #f00;
		display: block;
		cursor: pointer;
		padding: 2px 5px;
		font-weight: bold;
		text-align: center;
		background-color: #f8f8f8;
	}
	.example i {
		width: 0;
		margin-left: 5px;
		display: inline-block;
		vertical-align: middle;
		border: 5px solid #f86;
		border-width: 5px 5px 0 5px;
		border-color: #f86 transparent transparent transparent;
	}
	.hidden {
		display: none;
	}
	
</style>
<!-- InstanceEndEditable -->
</head>
<body>
	<div class="main">
		<!-- InstanceBeginEditable name="content" -->
		<h1>第9章 使用ContentProvider实现数据共享(P365)</h1>
		<h2>本章要点</h2>
		<table cellpadding="0" cellspacing="0">
			<tr>
				<td>理解ContentProvider的功能与意义</td>
				<td>ContentProvider类的作用和常用方法</td>
				<td>Uri对ContentProvider的作用</td>
			</tr>
			<tr>
				<td>使用ContentResolver操作数据</td>
				<td>操作系统ContentProvider提供的数据</td>
				<td>实现自己的ContentProvider</td>
			</tr>
			<tr>
				<td>配置ContentProvider</td>
				<td>监听ContentProvider的数据改变</td>
				<td>ConentObserver的作用和常用方法</td>
			</tr>
			<tr>
				<td>监听系统ContentProvider的数据改变</td>
			</tr>
		</table>
		<h2>9.1 数据共享标准: ContentProvider简介(P366)</h2>
		<p class="point3">
			ContentProvider以某种Uri的形式对外提供数据, 允许其他应用程序访问或修改数据; 其他应用程序使用ContentResolver根据Uri去访问操作指定数据.
		</p>
		<h3>9.1.1 ContentProvider简介(P366)</h3>
		<p class="point3">
			ContentProvider开发步骤:<br>
			&nbsp;&nbsp;&nbsp;&nbsp;1. 定义自己的ContentProvider类, 需要继承Android提供的ContentProvider基类;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;2. 在AndroidManifest.xml中注册ContentProvider, 注册时需要绑定一个Uri.
		</p>
		<h3>9.1.2 Uri简介(P367)</h3>
		<p class="point3">
			将字符串转换为Uri的方法: Uri uri = Uri.parse("content://xx.xxx.xxx.xx/word")
		</p>
		<h3>9.1.3 使用ContentResolver操作数据(P368)</h3>
		<p class="point3">
			Context获取ContentResolver对象的方法: getContentResolver().
		</p>
		<h2>9.2 操作系统的ContentProvider(P369)</h2>
		<h3>9.2.1 使用ContentProvider管理联系人	(P369)</h3>
		<p class="point3">
			Context访问数据文件夹的方法:<br>
			&nbsp;&nbsp;&nbsp;&nbsp;1. getDir(String name, int mode): 在应用程序数据文件夹下获取或创建name对应的子目录;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;2. File getFilesDir(): 获取该应用程序的数据文件夹的绝对路径;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;3. String[] fileList(): 返回该应用程序数据文件夹下的所有文件;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;4. deleteFile(String name): 删除该应用程序数据文件夹下的指定文件.
		</p>
		<h3>9.2.2 使用ContentProvider管理多媒体内容(P375)</h3>
		<p class="point3">
			Android为多媒体提供的ContentProvider的Uri:<br>
			&nbsp;&nbsp;&nbsp;&nbsp;1. MediaStore.Audio.Media.EXTERNAL_CONTENT_URI: 存储在外部存储卡(SD卡)上的音频文件内容的ContentProvider的Uri;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;2. MediaStore.Audio.Media.INTERNAL_CONTENT_URI: 存储在手机内部存储器上的音频文件内容的ContentProvider的Uri;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;3. MediaStore.Audio.Image.EXTERNAL_CONTENT_URI: 存储在外部存储卡(SD卡)上的图片文件内容的ContentProvider的Uri;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;4. MediaStore.Audio.Image.INTERNAL_CONTENT_URI: 存储在手机内部存储器上的图片文件内容的ContentProvider的Uri;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;5. MediaStore.Audio.Video.EXTERNAL_CONTENT_URI: 存储在外部存储卡(SD卡)上的音频文件内容的ContentProvider的Uri;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;6. MediaStore.Audio.Video.INTERNAL_CONTENT_URI: 储在手机内部存储器上的音频文件内容的ContentProvider的Uri.
		</p>
		<h2>9.3 实现ContentProvider(P378)</h2>
		<h3>9.3.1 创建ContentProvider的步骤</h3>
		<p class="point3">
			ContentProvider开发步骤:<br>
			&nbsp;&nbsp;&nbsp;&nbsp;1. 实现一个ContentProvider子类, 需要实现增删改查等方法;</br>
			&nbsp;&nbsp;&nbsp;&nbsp;2. 在AndroidManifest.xml文件中注册该ContentProvider.
		</p>
		<p class="point3">
			相关类和方法:<br>
			&nbsp;&nbsp;&nbsp;&nbsp;1. UriMatcher:<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void addURI(String authority, String path, int code);<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int match(Uri uri): 返回标志码(code);<br>
			<strong>ContentProvider可以在一个应用或不同应用中使用.</strong>
		</p>
		<h2>9.4 监听ContentProvider的数据改变(P384)</h2>
		<h3>9.4.1 ContentObserver简介(P384)</h3>
		<p class="point3">
			通知注册在特定Uri上的监听者数据改变的方法:<br>
			&nbsp;&nbsp;&nbsp;&nbsp;getContext().getContentResolver().notifyChange(uri, null);<br>
			为了监听指定ContentProvider的数据变化, 需要通过ContentResolver向指定Uri注册ContentObserver监听器.<br>
			ContentResolver注册监听器的方法:<br>
			&nbsp;&nbsp;&nbsp;&nbsp;registerContentObserver(Uri uri, boolean notifyForDescendents, ContentObserver observer): notifyForDescendents为true, 假如注册监听的uri为content://abc, 那么Uri为content://abc/xyz的数据改变时也会触发该监听器; 如果为false, 就不会触发.
			
		</p>
		<h2>9.5 本章小结(P386)</h2>
		<!-- InstanceEndEditable -->
	</div>
	<script type="text/javascript">
		window.onload = function() {
			var examples = document.getElementsByClassName("exampleCode"),
				len = examples.length;
			for(var i=0; i<len; i++) {
				examples[i].onclick = function() {
					showCode(this);
				}
			}
		};
		function showCode( element ) {
			console.log("click");
			var childNodes = element.childNodes,
				len = childNodes.length,
				codeNode, cls = "";
			for(var i=0; i<len; i++) {
				if(childNodes[i].getAttribute != undefined) {
					cls = childNodes[i].getAttribute("class");
				}
				if(cls != null && cls.length > 0 && cls.indexOf("hidden") > -1) {
					codeNode = childNodes[i];
					break;
				}
			}
			if( codeNode.style.display == "" || codeNode.style.display == "none") {
				codeNode.style.display = "block";
			} else {
				codeNode.style.display = "none";
			}
		}
	</script>
</body>
<!-- InstanceEnd -->
</html>